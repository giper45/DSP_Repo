{"description":"Crack the password of the wifi!","goal":"<p>Crack the password of the wifi!</p>\n<p><strong>NOTE</strong> : Before you start the lab, open a terminal and run :</p>\n<p><em>modprobe mac80211_hwsim</em></p>\n<p>This is a simulator of 802.11 radio(s), so you will not need a functioning network card to practice Wifi Hacking! If you don't see the packets immediately after the lab is up and running, wait until 40/50 seconds. You may also need to setup a bigger mtu for this lab.</p>\n<p><em>ifconfig wlan1mon mtu 2200</em> (or wlan1mon, check with airmon-ng)</p>\n<p>&nbsp;</p>\n<p>&nbsp;P.S. if you are curious to know how it works, check out my github repo&nbsp; <a href=\"https://github.com/ale753/shinai-fi\">https://github.com/ale753/shinai-fi</a></p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>","solution":"<p>WEP is a security algorithm for 802.11 wireless networks introduced in 1997. It is NOT a secure way to encrypt your data, but it is good to study it for academic and learning purposes.</p>\n<p>WEP has no real authentication phase, no key rotation and no protection against replay attack, so it can easly hacked. Also RC4 stream cipher is very vulnerable. The approach used in this lab is passive, so we will sniff the traffic without inject any packet ourselves.</p>\n<p>Our goal is to capture as many packets as possible in order to collect the Initialization Vectors (IV) to idenfity the keystream.</p>\n<p>Open a terminal and setup your wireless card in monitor mode :</p>\n<p><em>airmon-ng start wlan1</em></p>\n<p>Check the name of the interface of wlan1 (in this case, wlan1mon)</p>\n<p><img src=\"https://i.postimg.cc/1tQfddgH/Screenshot-from-2020-10-09-22-08-52.png\" alt=\"\" width=\"640\" height=\"254\" /></p>\n<p>Let's start sniffing the packets with :</p>\n<p><em>airodump-ng wlan1mon -w wep_packets.cap</em></p>\n<p>In this way we will store our IV's in wep_packets.cap and we will be able to crack the password later. If you don't see the packets immediately after the lab is up and running, wait until 40/50 seconds. An AP with WEP encryption will show up on channel 1.</p>\n<p><img src=\"https://i.postimg.cc/sx1yHPJm/Screenshot-from-2020-10-09-22-11-08.png\" alt=\"\" width=\"673\" height=\"164\" /></p>\n<p>Collect as many packets as you can (minimum is 50'000 for a 40bit key, 700'000 or plus for 128 bit) and stop airodump-ng with CTRL-C.</p>\n<p><img src=\"https://i.postimg.cc/T2ZYNSZW/Screenshot-from-2020-10-09-22-12-37.png\" alt=\"\" width=\"691\" height=\"192\" /></p>\n<p>Now find your capture file (.cap) in your home directory (or in whatever folder you stored it). Launch aircrack-ng to find the 40 bit key.</p>\n<p><em>aircrack-ng wep_packets.cap-01.cap</em></p>\n<p><img src=\"https://i.postimg.cc/Ls6HZMZG/Screenshot-from-2020-10-09-22-21-20.png\" alt=\"\" width=\"535\" height=\"274\" /></p>\n<p>Key found! !7x/j</p>\n<p>&nbsp;</p>\n<p><strong>Plus section : Active Attack and Fake Authentication</strong></p>\n<p>Because WEP has no protection against replay attack, you can easly send packets in the network using aireplay-ng. You will need to \"spoof\" a valid MAC address, for example in our case the station 90:17:C8:56:15:F3, and send a very large number of ARP requests to force the AP to create the IV's. This is also called \"fake authentication\".</p>\n<p><em>aireplay-ng -1 0 -a &lt;target mac&gt; &lt;interface name&gt;</em></p>\n<p>In our case: a<em>ireplay-ng -1 0 -a 2C:D8:5A:9E:10:46 -h 90:17:C8:56:15:F3 wlan1mon</em></p>\n<p>However, if you do not specify a MAC address with -h, aireplay will choose one in automatic.</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>","author":"Alessandro753"}
